import Head from 'next/head'
import Image from 'next/image'
import styles from '../styles/Home.module.css'
import { client } from '../lib/sanity'
import Link from 'next/link'
import BlogCard from '../components/BlogCard'

const postsQuery = `*[_type == 'post'] {
  _id,
  slug,
  publishedAt,
  author->{name},
  title,
  description,
  mainImage,
  categories
} `

export default function Home({posts}) {
  console.log('posts: ', posts);
  return (
    <>
    <Head>
        <title>Blog!</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

        <div className='max-wf-lg m-2'>
       
        <ul className='space-y-12 flex flex-col'>
          {posts?.length > 0 && posts.map(post => (

            <BlogCard key={post._id} post={post} />
            ))}
        </ul>

    </div>
            </>
  )
}

export const getStaticProps = async () => {
  const posts = await client.fetch(postsQuery)
  console.log('posts: ', posts)
  return {
    props: { posts },
  }
}
